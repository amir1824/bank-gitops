# Mizrahi Bank - Apps Chart Values
# This file controls which applications are deployed via the App of Apps pattern

# ============================================================================
# Global Configuration
# ============================================================================
global:
  # Environment name (dev, staging, prod)
  environment: dev
  
  # Git repository configuration
  repoURL: https://github.com/amir1824/bank-gitops.git
  targetRevision: main
  
  # ArgoCD configuration
  argocdNamespace: openshift-gitops
  destinationServer: https://kubernetes.default.svc
  
  # Target namespace for all workloads
  namespace: mizrahi-core
  
  # OpenShift domain for Routes
  domain: apps.ocp.mizrahi.local
  
  # Sync policy defaults for all applications
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - PruneLast=true
    retry:
      limit: 5
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m

# ============================================================================
# Infrastructure Layer
# ============================================================================
infrastructure:
  # Apache Kafka (via Strimzi Operator)
  kafka:
    enabled: true
    syncWave: 10
    # Path to Kafka manifests
    path: components/infra/kafka
    # Kafka-specific overrides
    namespace: mizrahi-core
    
  # Redis Cache
  redis:
    enabled: true
    syncWave: 10
    # Path to Redis manifests
    path: components/infra/redis
    namespace: mizrahi-core

# ============================================================================
# Application Layer
# ============================================================================
applications:
  # Mainframe Mock Service (Python)
  mainframeMock:
    enabled: true
    syncWave: 20
    # Path to Helm chart
    path: charts/mainframe-mock
    namespace: mizrahi-core
    # Helm values override
    helm:
      releaseName: mainframe-mock
      values:
        replicaCount: 1
        route:
          enabled: true
          host: ""  # Auto-generated by OpenShift
  
  # Account Service (.NET Core)
  accountService:
    enabled: true
    syncWave: 20
    # Path to Helm chart
    path: charts/account-service
    namespace: mizrahi-core
    # Helm values override
    helm:
      releaseName: account-service
      values:
        replicaCount: 2
        route:
          enabled: true
          host: ""  # Auto-generated by OpenShift

# ============================================================================
# Environment-Specific Overrides
# ============================================================================

# Development environment settings
dev:
  infrastructure:
    kafka:
      replicas: 1
    redis:
      replicas: 1
  applications:
    mainframeMock:
      replicas: 1
    accountService:
      replicas: 1

# Production environment settings
prod:
  infrastructure:
    kafka:
      replicas: 3
    redis:
      replicas: 3
  applications:
    mainframeMock:
      replicas: 2
    accountService:
      replicas: 3
